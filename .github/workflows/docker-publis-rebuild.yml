name: Docker rebuild

on:
  workflow_dispatch:

env:
  IMAGE_NAME: klustair

jobs:
  # Push image to GitHub Packages.
  # See also https://docs.docker.com/docker-hub/builds/
  push:

    runs-on: ubuntu-latest
    strategy:
      matrix:
        versiontag: ["v0.3.3", "v0.4.0", "v0.4.1"]
    steps:
      - uses: actions/checkout@v2
      - run: git checkout tags/${{ matrix.versiontag }}

      - name: Build image ${{ matrix.versiontag }}
        run: | 
          docker build . --file Dockerfile --tag ${IMAGE_NAME}
          docker images --digests